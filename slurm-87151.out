/var/spool/slurmd/job87151/slurm_script: 14: conda: not found
/var/spool/slurmd/job87151/slurm_script: 15: conda: not found
Fold 0
Let's use 2 GPUs!
Training Epoch: 1 / 500, Fold: 0
  0%|          | 0/194 [00:00<?, ?it/s]  1%|          | 1/194 [00:04<15:38,  4.86s/it]  1%|          | 2/194 [00:08<12:19,  3.85s/it]  2%|▏         | 3/194 [00:11<12:00,  3.77s/it]  2%|▏         | 4/194 [00:14<10:37,  3.36s/it]  3%|▎         | 5/194 [00:17<10:14,  3.25s/it]  3%|▎         | 6/194 [00:20<09:39,  3.08s/it]  4%|▎         | 7/194 [00:23<09:31,  3.06s/it]  4%|▍         | 8/194 [00:25<09:01,  2.91s/it]  5%|▍         | 9/194 [00:29<09:29,  3.08s/it]  5%|▌         | 10/194 [00:31<08:54,  2.91s/it]  6%|▌         | 11/194 [00:34<08:52,  2.91s/it]  6%|▌         | 12/194 [00:37<08:15,  2.72s/it]  7%|▋         | 13/194 [00:39<08:18,  2.75s/it]  7%|▋         | 14/194 [00:43<09:19,  3.11s/it]  8%|▊         | 15/194 [00:46<09:01,  3.03s/it]  8%|▊         | 16/194 [00:49<08:59,  3.03s/it]  9%|▉         | 17/194 [00:52<08:44,  2.96s/it]  9%|▉         | 18/194 [00:55<08:44,  2.98s/it] 10%|▉         | 19/194 [00:58<08:52,  3.04s/it] 10%|█         | 20/194 [01:01<08:49,  3.04s/it] 11%|█         | 21/194 [01:04<08:37,  2.99s/it] 11%|█▏        | 22/194 [01:07<08:40,  3.02s/it] 12%|█▏        | 23/194 [01:10<08:23,  2.94s/it] 12%|█▏        | 24/194 [01:13<08:25,  2.97s/it] 13%|█▎        | 25/194 [01:17<09:30,  3.37s/it] 13%|█▎        | 26/194 [01:21<09:21,  3.34s/it] 14%|█▍        | 27/194 [01:24<09:01,  3.24s/it] 14%|█▍        | 28/194 [01:26<08:39,  3.13s/it] 15%|█▍        | 29/194 [01:29<08:28,  3.08s/it] 15%|█▌        | 30/194 [01:32<08:09,  2.98s/it] 16%|█▌        | 31/194 [01:35<07:40,  2.82s/it] 16%|█▋        | 32/194 [01:38<08:24,  3.12s/it] 17%|█▋        | 33/194 [01:41<07:56,  2.96s/it] 18%|█▊        | 34/194 [01:44<07:37,  2.86s/it] 18%|█▊        | 35/194 [01:46<07:26,  2.81s/it] 19%|█▊        | 36/194 [01:49<07:10,  2.72s/it] 19%|█▉        | 37/194 [01:52<07:26,  2.85s/it] 20%|█▉        | 38/194 [01:54<07:07,  2.74s/it] 20%|██        | 39/194 [01:57<07:11,  2.79s/it] 21%|██        | 40/194 [02:00<06:59,  2.72s/it] 21%|██        | 41/194 [02:03<06:53,  2.70s/it] 22%|██▏       | 42/194 [02:06<07:03,  2.79s/it] 22%|██▏       | 43/194 [02:09<07:23,  2.93s/it] 23%|██▎       | 44/194 [02:11<07:02,  2.81s/it] 23%|██▎       | 45/194 [02:14<06:47,  2.73s/it] 24%|██▎       | 46/194 [02:17<07:00,  2.84s/it] 24%|██▍       | 47/194 [02:20<07:06,  2.90s/it] 25%|██▍       | 48/194 [02:23<07:13,  2.97s/it] 25%|██▌       | 49/194 [02:26<06:45,  2.79s/it] 26%|██▌       | 50/194 [02:28<06:43,  2.80s/it] 26%|██▋       | 51/194 [02:31<06:22,  2.68s/it] 27%|██▋       | 52/194 [02:33<06:09,  2.60s/it] 27%|██▋       | 53/194 [02:35<05:51,  2.49s/it] 28%|██▊       | 54/194 [02:38<06:07,  2.62s/it] 28%|██▊       | 55/194 [02:41<06:06,  2.64s/it] 29%|██▉       | 56/194 [02:44<06:08,  2.67s/it] 29%|██▉       | 57/194 [02:47<06:24,  2.81s/it] 30%|██▉       | 58/194 [02:49<06:12,  2.74s/it] 30%|███       | 59/194 [02:52<06:03,  2.70s/it] 31%|███       | 60/194 [02:55<05:50,  2.62s/it] 31%|███▏      | 61/194 [02:58<06:12,  2.80s/it] 32%|███▏      | 62/194 [03:00<06:02,  2.75s/it] 32%|███▏      | 63/194 [03:03<06:12,  2.84s/it] 33%|███▎      | 64/194 [03:06<06:12,  2.86s/it] 34%|███▎      | 65/194 [03:09<06:06,  2.84s/it] 34%|███▍      | 66/194 [03:12<05:55,  2.78s/it] 35%|███▍      | 67/194 [03:14<05:51,  2.76s/it] 35%|███▌      | 68/194 [03:18<06:00,  2.86s/it] 36%|███▌      | 69/194 [03:21<06:09,  2.95s/it] 36%|███▌      | 70/194 [03:23<05:48,  2.81s/it] 37%|███▋      | 71/194 [03:26<06:01,  2.94s/it] 37%|███▋      | 72/194 [03:30<06:13,  3.06s/it] 38%|███▊      | 73/194 [03:33<06:24,  3.18s/it] 38%|███▊      | 74/194 [03:37<06:48,  3.40s/it] 39%|███▊      | 75/194 [03:40<06:37,  3.34s/it] 39%|███▉      | 76/194 [03:43<06:18,  3.21s/it] 40%|███▉      | 77/194 [03:47<06:31,  3.35s/it] 40%|████      | 78/194 [03:51<06:52,  3.55s/it] 41%|████      | 79/194 [03:55<06:47,  3.54s/it] 41%|████      | 80/194 [03:58<06:44,  3.55s/it] 42%|████▏     | 81/194 [04:02<06:51,  3.64s/it] 42%|████▏     | 82/194 [04:05<06:19,  3.39s/it] 43%|████▎     | 83/194 [04:09<06:37,  3.58s/it] 43%|████▎     | 84/194 [04:13<07:06,  3.88s/it] 44%|████▍     | 85/194 [04:17<06:44,  3.71s/it] 44%|████▍     | 86/194 [04:20<06:34,  3.65s/it] 45%|████▍     | 87/194 [04:24<06:32,  3.67s/it] 45%|████▌     | 88/194 [04:27<05:58,  3.39s/it] 46%|████▌     | 89/194 [04:30<05:47,  3.31s/it] 46%|████▋     | 90/194 [04:33<05:37,  3.25s/it] 47%|████▋     | 91/194 [04:37<06:13,  3.63s/it] 47%|████▋     | 92/194 [04:40<05:54,  3.48s/it] 48%|████▊     | 93/194 [04:44<06:01,  3.57s/it] 48%|████▊     | 94/194 [04:48<05:55,  3.55s/it] 49%|████▉     | 95/194 [04:51<05:45,  3.49s/it] 49%|████▉     | 96/194 [04:55<05:59,  3.67s/it] 50%|█████     | 97/194 [04:59<06:05,  3.77s/it] 51%|█████     | 98/194 [05:02<05:47,  3.62s/it] 51%|█████     | 99/194 [05:05<05:25,  3.42s/it] 52%|█████▏    | 100/194 [05:09<05:15,  3.36s/it] 52%|█████▏    | 101/194 [05:12<05:08,  3.31s/it] 53%|█████▎    | 102/194 [05:16<05:18,  3.46s/it] 53%|█████▎    | 103/194 [05:20<05:30,  3.63s/it] 54%|█████▎    | 104/194 [05:23<05:24,  3.61s/it] 54%|█████▍    | 105/194 [05:27<05:15,  3.55s/it] 55%|█████▍    | 106/194 [05:30<05:15,  3.59s/it] 55%|█████▌    | 107/194 [05:33<04:58,  3.43s/it] 56%|█████▌    | 108/194 [05:37<04:54,  3.43s/it] 56%|█████▌    | 109/194 [05:40<04:47,  3.38s/it] 57%|█████▋    | 110/194 [05:43<04:28,  3.20s/it] 57%|█████▋    | 111/194 [05:46<04:14,  3.06s/it] 58%|█████▊    | 112/194 [05:48<04:06,  3.01s/it] 58%|█████▊    | 113/194 [05:53<04:42,  3.49s/it] 59%|█████▉    | 114/194 [05:56<04:35,  3.44s/it] 59%|█████▉    | 115/194 [06:00<04:28,  3.39s/it] 60%|█████▉    | 116/194 [06:03<04:13,  3.26s/it] 60%|██████    | 117/194 [06:06<04:06,  3.20s/it] 61%|██████    | 118/194 [06:10<04:24,  3.48s/it] 61%|██████▏   | 119/194 [06:14<04:31,  3.62s/it] 62%|██████▏   | 120/194 [06:16<04:07,  3.35s/it] 62%|██████▏   | 121/194 [06:20<04:03,  3.34s/it] 63%|██████▎   | 122/194 [06:23<04:02,  3.36s/it] 63%|██████▎   | 123/194 [06:26<03:44,  3.17s/it] 64%|██████▍   | 124/194 [06:30<04:03,  3.47s/it] 64%|██████▍   | 125/194 [06:34<04:05,  3.55s/it] 65%|██████▍   | 126/194 [06:37<03:53,  3.43s/it] 65%|██████▌   | 127/194 [06:40<03:50,  3.44s/it] 66%|██████▌   | 128/194 [06:44<03:54,  3.56s/it] 66%|██████▋   | 129/194 [06:47<03:36,  3.33s/it] 67%|██████▋   | 130/194 [06:51<03:34,  3.35s/it] 68%|██████▊   | 131/194 [06:54<03:25,  3.26s/it] 68%|██████▊   | 132/194 [06:57<03:17,  3.18s/it] 69%|██████▊   | 133/194 [07:00<03:20,  3.29s/it] 69%|██████▉   | 134/194 [07:03<03:18,  3.31s/it] 70%|██████▉   | 135/194 [07:07<03:11,  3.24s/it] 70%|███████   | 136/194 [07:10<03:11,  3.30s/it] 71%|███████   | 137/194 [07:13<03:06,  3.26s/it] 71%|███████   | 138/194 [07:17<03:06,  3.33s/it] 72%|███████▏  | 139/194 [07:19<02:54,  3.17s/it] 72%|███████▏  | 140/194 [07:24<03:13,  3.58s/it] 73%|███████▎  | 141/194 [07:27<02:55,  3.31s/it] 73%|███████▎  | 142/194 [07:31<03:00,  3.47s/it] 74%|███████▎  | 143/194 [07:35<03:17,  3.87s/it] 74%|███████▍  | 144/194 [07:38<02:59,  3.58s/it] 75%|███████▍  | 145/194 [07:45<03:36,  4.42s/it] 75%|███████▌  | 146/194 [07:48<03:21,  4.20s/it] 76%|███████▌  | 147/194 [07:51<03:01,  3.87s/it] 76%|███████▋  | 148/194 [07:55<02:54,  3.79s/it] 77%|███████▋  | 149/194 [07:59<02:50,  3.79s/it] 77%|███████▋  | 150/194 [08:02<02:35,  3.54s/it] 78%|███████▊  | 151/194 [08:05<02:34,  3.58s/it] 78%|███████▊  | 152/194 [08:09<02:28,  3.54s/it] 79%|███████▉  | 153/194 [08:12<02:21,  3.46s/it] 79%|███████▉  | 154/194 [08:15<02:12,  3.31s/it] 80%|███████▉  | 155/194 [08:18<02:06,  3.25s/it] 80%|████████  | 156/194 [08:21<01:57,  3.09s/it] 81%|████████  | 157/194 [08:24<01:59,  3.24s/it] 81%|████████▏ | 158/194 [08:27<01:52,  3.12s/it] 82%|████████▏ | 159/194 [08:31<01:49,  3.13s/it] 82%|████████▏ | 160/194 [08:36<02:08,  3.77s/it] 83%|████████▎ | 161/194 [08:39<02:03,  3.73s/it] 84%|████████▎ | 162/194 [08:42<01:53,  3.54s/it] 84%|████████▍ | 163/194 [08:46<01:45,  3.40s/it] 85%|████████▍ | 164/194 [08:49<01:46,  3.54s/it] 85%|████████▌ | 165/194 [08:52<01:37,  3.36s/it] 86%|████████▌ | 166/194 [08:56<01:36,  3.45s/it] 86%|████████▌ | 167/194 [08:59<01:27,  3.24s/it] 87%|████████▋ | 168/194 [09:02<01:22,  3.19s/it] 87%|████████▋ | 169/194 [09:06<01:24,  3.39s/it] 88%|████████▊ | 170/194 [09:09<01:19,  3.32s/it] 88%|████████▊ | 171/194 [09:12<01:18,  3.40s/it] 89%|████████▊ | 172/194 [09:16<01:17,  3.52s/it] 89%|████████▉ | 173/194 [09:19<01:11,  3.40s/it] 90%|████████▉ | 174/194 [09:23<01:07,  3.35s/it] 90%|█████████ | 175/194 [09:26<01:05,  3.44s/it] 91%|█████████ | 176/194 [09:29<00:58,  3.25s/it] 91%|█████████ | 177/194 [09:33<01:00,  3.55s/it] 92%|█████████▏| 178/194 [09:36<00:51,  3.23s/it] 92%|█████████▏| 179/194 [09:39<00:49,  3.30s/it] 93%|█████████▎| 180/194 [09:43<00:48,  3.47s/it] 93%|█████████▎| 181/194 [09:46<00:42,  3.27s/it] 94%|█████████▍| 182/194 [09:49<00:40,  3.34s/it] 94%|█████████▍| 183/194 [09:52<00:35,  3.25s/it] 95%|█████████▍| 184/194 [09:56<00:32,  3.23s/it] 95%|█████████▌| 185/194 [09:59<00:29,  3.24s/it] 96%|█████████▌| 186/194 [10:03<00:26,  3.34s/it] 96%|█████████▋| 187/194 [10:06<00:23,  3.40s/it] 97%|█████████▋| 188/194 [10:09<00:20,  3.34s/it] 97%|█████████▋| 189/194 [10:13<00:17,  3.49s/it] 98%|█████████▊| 190/194 [10:17<00:14,  3.52s/it] 98%|█████████▊| 191/194 [10:20<00:10,  3.49s/it] 99%|█████████▉| 192/194 [10:23<00:06,  3.34s/it] 99%|█████████▉| 193/194 [10:26<00:03,  3.29s/it]100%|██████████| 194/194 [10:29<00:00,  3.26s/it]100%|██████████| 194/194 [10:29<00:00,  3.25s/it]
Validation Epoch: 1 / 500, Fold: 0
  0%|          | 0/97 [00:00<?, ?it/s]  0%|          | 0/97 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/ssd/ext-6401/PSCC-IPParis-Challenge/src/train.py", line 84, in <module>
    val_loss = engine.evaluate(val_dataset, val_loader, model)
  File "/home/ssd/ext-6401/PSCC-IPParis-Challenge/src/engine.py", line 44, in evaluate
    loss = criterion(output, targets)
NameError: name 'criterion' is not defined
